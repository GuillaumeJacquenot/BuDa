<html>
<head>
  <title>producer MQTT</title>
  <script src="./mqtt.min.js"></script>
  <script src="./elmrabbitmq.js"></script>
  <style>
    input {
      box-sizing: border-box;
      width: 10em;
    }

    #url
    , #topic {
        width: 20em;
    }
  </style>
</head>
<body>
<div>
<text>url rabbitmq Mqtt:</text>
<input id="url" value="mqtt://130.66.124.234:15675/ws" width="10em"/>
</div>
<div>
<text>topic:</text>
<input id="topic" value="michel.node.create" />
</div>
<div>
<text>bloc ID:</text>
<input id="blocId" value="41" />
</div>
<div>
<text>bloc Name:</text>
<input id="blocName" value="Bloc41" />
</div>
<script>

var send = function () {
  var url = document.getElementById("url").value;
  var topic = document.getElementById("topic").value;
  var blocId = document.getElementById("blocId").value;
  var blocName = document.getElementById("blocName").value;

  // {"header":"alan.node.create","data":{"id":1,"name":"n","parent":null,"attribut":null,"geometry":null,"group":[],"highLighted":0,"position":{"x":0,"y":0},"blow":0}}

  var msg = {"header":topic,"data":{"id":blocId,"name":blocName,"parent":null,"attribut":null,"geometry":null,"group":[],"highLighted":0,"position":{"x":0,"y":0},"blow":0}};
  var options = {"mqtt": {"url": url, "topic": topic, consumer:false, "clientId": "michel"}};

  UpdateOptions(JSON.stringify(options));
  connectMQTT();
  var encode = {"mqtt": {"url": url, "topic": "architecture." + topic, consumer:false, "clientId": "michel"}, "message": msg};
  sendDataToMQTT(JSON.stringify(encode));

};

</script>
<button onClick=send()>"send msg"</button>
</body>
</html>
